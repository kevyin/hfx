-- GENERATED by C->Haskell Compiler, version 0.16.3 Crystal Seed, 24 Jan 2009 (Haskell)
-- Edit the ORIGNAL .chs file instead!


{-# LINE 1 "./Foreign/CUDA/Runtime/Utils.chs" #-}{-# LANGUAGE ForeignFunctionInterface #-}
--------------------------------------------------------------------------------
-- |
-- Module    : Foreign.CUDA.Runtime.Utils
-- Copyright : (c) [2009..2011] Trevor L. McDonell
-- License   : BSD
--
-- Utility functions
--
--------------------------------------------------------------------------------

module Foreign.CUDA.Runtime.Utils (runtimeVersion, driverVersion)
  where


{-# LINE 16 "./Foreign/CUDA/Runtime/Utils.chs" #-}

-- Friends
import Foreign.CUDA.Runtime.Error
import Foreign.CUDA.Internal.C2HS

-- System
import Foreign
import Foreign.C


-- |
-- Return the version number of the installed CUDA driver
--
runtimeVersion :: IO Int
runtimeVersion =  resultIfOk =<< cudaRuntimeGetVersion

cudaRuntimeGetVersion :: IO (Status, Int)
cudaRuntimeGetVersion =
  alloca $ \a1' -> 
  cudaRuntimeGetVersion'_ a1' >>= \res ->
  peekIntConv  a1'>>= \a1'' -> 
  let {res' = cToEnum res} in
  return (res', a1'')
{-# LINE 34 "./Foreign/CUDA/Runtime/Utils.chs" #-}


-- |
-- Return the version number of the installed CUDA runtime
--
driverVersion :: IO Int
driverVersion =  resultIfOk =<< cudaDriverGetVersion

cudaDriverGetVersion :: IO (Status, Int)
cudaDriverGetVersion =
  alloca $ \a1' -> 
  cudaDriverGetVersion'_ a1' >>= \res ->
  peekIntConv  a1'>>= \a1'' -> 
  let {res' = cToEnum res} in
  return (res', a1'')
{-# LINE 44 "./Foreign/CUDA/Runtime/Utils.chs" #-}


foreign import ccall unsafe "Foreign/CUDA/Runtime/Utils.chs.h cudaRuntimeGetVersion"
  cudaRuntimeGetVersion'_ :: ((Ptr CInt) -> (IO CInt))

foreign import ccall unsafe "Foreign/CUDA/Runtime/Utils.chs.h cudaDriverGetVersion"
  cudaDriverGetVersion'_ :: ((Ptr CInt) -> (IO CInt))
